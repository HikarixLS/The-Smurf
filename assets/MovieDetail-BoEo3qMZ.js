import{j as e,L as Y}from"./index-BDTOxS1D.js";import{f as J,u as Z,b as i}from"./vendor-DbVhFtnB.js";import{H as N,h as ee,i as se,j as ae,k as te,F as T,l as ne,m as ie,n as le,o as G}from"./Header-CcEJfMqN.js";import{F as $}from"./Footer-De9tRN7s.js";import{M as ce}from"./MovieRow-C-zdAan1.js";import{m as r}from"./movieService-BuZ_f8lD.js";import{g as F,s as oe}from"./MovieCard-CbBsXmNZ.js";import"./endpoints-CNvTD5q0.js";import"./index-CO4GaNJo.js";const re="_movieDetail_uqhun_1",de="_errorPage_uqhun_7",he="_homeBtn_uqhun_22",me="_hero_uqhun_39",ue="_heroImage_uqhun_46",_e="_heroOverlay_uqhun_55",ge="_heroContent_uqhun_64",pe="_posterWrapper_uqhun_76",xe="_poster_uqhun_76",je="_heroInfo_uqhun_88",ve="_title_uqhun_93",Ne="_originName_uqhun_101",ye="_metaRow_uqhun_109",be="_ratingBadge_uqhun_117",qe="_metaBadge_uqhun_130",fe="_qualityBadge_uqhun_142",we="_langBadge_uqhun_152",Be="_genres_uqhun_163",Ie="_genreTag_uqhun_170",ke="_actions_uqhun_187",Ce="_watchBtn_uqhun_194",Se="_actionBtn_uqhun_215",Te="_active_uqhun_239",Ge="_tabSection_uqhun_246",$e="_tabs_uqhun_252",Fe="_tab_uqhun_246",Le="_tabActive_uqhun_276",Pe="_tabContent_uqhun_282",Re="_overview_uqhun_299",Me="_description_uqhun_305",Ae="_detailGrid_uqhun_312",De="_detailItem_uqhun_318",He="_detailLabel_uqhun_328",Ke="_episodeGrid_uqhun_341",We="_episodeBtn_uqhun_347",ze="_castGrid_uqhun_369",Ee="_castItem_uqhun_375",Oe="_castAvatar_uqhun_385",Ue="_castName_uqhun_399",Qe="_castPhoto_uqhun_404",Ve="_castInfo_uqhun_413",Xe="_castRole_uqhun_420",Ye="_keywords_uqhun_429",Je="_keywordsIcon_uqhun_437",Ze="_keywordTag_uqhun_443",es="_gallerySection_uqhun_453",ss="_galleryTitle_uqhun_457",as="_galleryGrid_uqhun_466",ts="_posterGrid_uqhun_473",ns="_galleryItem_uqhun_480",is="_lightbox_uqhun_502",ls="_lightboxClose_uqhun_522",cs="_empty_uqhun_544",s={movieDetail:re,errorPage:de,homeBtn:he,hero:me,heroImage:ue,heroOverlay:_e,heroContent:ge,posterWrapper:pe,poster:xe,heroInfo:je,title:ve,originName:Ne,metaRow:ye,ratingBadge:be,metaBadge:qe,qualityBadge:fe,langBadge:we,genres:Be,genreTag:Ie,actions:ke,watchBtn:Ce,actionBtn:Se,active:Te,tabSection:Ge,tabs:$e,tab:Fe,tabActive:Le,tabContent:Pe,overview:Re,description:Me,detailGrid:Ae,detailItem:De,detailLabel:He,episodeGrid:Ke,episodeBtn:We,castGrid:ze,castItem:Ee,castAvatar:Oe,castName:Ue,castPhoto:Qe,castInfo:Ve,castRole:Xe,keywords:Ye,keywordsIcon:Je,keywordTag:Ze,gallerySection:es,galleryTitle:ss,galleryGrid:as,posterGrid:ts,galleryItem:ns,lightbox:is,lightboxClose:ls,empty:cs},d="https://image.tmdb.org/t/p",xs=()=>{const{slug:l}=J(),h=Z(),[t,L]=i.useState(null),[P,y]=i.useState(!0),[b,m]=i.useState(null),[o,R]=i.useState("overview"),[q,M]=i.useState([]),[f,A]=i.useState(!1),[w,D]=i.useState(!1),[c,H]=i.useState(null),[u,K]=i.useState(null),[B,W]=i.useState(null),[I,_]=i.useState(null);i.useEffect(()=>{z()},[l]);const z=async()=>{y(!0),m(null);try{const a=await r.getMovieDetail(l);if(a?.data?.item){L(a.data.item);const[n,x,j,v]=await Promise.allSettled([a.data.item.category?.length>0?r.getMoviesByCategory(a.data.item.category[0].slug,1):Promise.resolve(null),r.getMovieImages(l),r.getMoviePeoples(l),r.getMovieKeywords(l)]);n.status==="fulfilled"&&n.value?.data?.items&&M(n.value.data.items.filter(X=>X.slug!==l)),x.status==="fulfilled"&&x.value?.data?.images&&H(x.value.data.images),j.status==="fulfilled"&&j.value?.data&&K(j.value.data),v.status==="fulfilled"&&v.value?.data?.keywords&&W(v.value.data.keywords)}else m("Không tìm thấy phim")}catch{m("Lỗi tải thông tin phim")}finally{y(!1)}},E=()=>h(`/watch/${l}`),O=()=>{navigator.share?navigator.share({title:t.name,url:window.location.href}):navigator.clipboard.writeText(window.location.href)};if(P)return e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Y,{})})]});if(b||!t)return e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsxs("div",{className:s.errorPage,children:[e.jsx("h1",{children:b||"Không tìm thấy phim"}),e.jsx("button",{className:s.homeBtn,onClick:()=>h("/"),children:"Về trang chủ"})]}),e.jsx($,{})]});const U=F(t.poster_url||t.thumb_url),Q=F(t.thumb_url||t.poster_url),k=t.tmdb?.vote_average||0,C=t.episodes?.[0]?.server_data||[],g=["overview","episodes","cast"];(c?.backdrops?.length>0||c?.posters?.length>0)&&g.push("gallery"),g.push("related");const V={overview:"Tổng quan",episodes:"Tập phim",cast:"Diễn viên",gallery:"Hình ảnh",related:"Đề xuất"},S=u?.cast?.length>0?u.cast.slice(0,20):t.actor?.map(a=>({name:a,profile_path:null}))||[],p=u?.crew?.filter(a=>a.job==="Director")||[];return e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsxs("main",{className:s.movieDetail,children:[e.jsxs("div",{className:s.hero,children:[e.jsx("img",{src:U,alt:"",className:s.heroImage}),e.jsx("div",{className:s.heroOverlay}),e.jsxs("div",{className:s.heroContent,children:[e.jsx("div",{className:s.posterWrapper,children:e.jsx("img",{src:Q,alt:t.name,className:s.poster})}),e.jsxs("div",{className:s.heroInfo,children:[e.jsx("h1",{className:s.title,children:t.name}),t.origin_name&&e.jsx("p",{className:s.originName,children:t.origin_name}),e.jsxs("div",{className:s.metaRow,children:[k>0&&e.jsxs("span",{className:s.ratingBadge,children:[e.jsx(ee,{})," ",k.toFixed(1)]}),t.year&&e.jsxs("span",{className:s.metaBadge,children:[e.jsx(se,{})," ",t.year]}),t.time&&e.jsxs("span",{className:s.metaBadge,children:[e.jsx(ae,{})," ",t.time]}),t.quality&&e.jsx("span",{className:s.qualityBadge,children:t.quality}),t.lang&&e.jsx("span",{className:s.langBadge,children:t.lang}),t.episode_current&&e.jsx("span",{className:s.metaBadge,children:t.episode_current})]}),t.category?.length>0&&e.jsx("div",{className:s.genres,children:t.category.map((a,n)=>e.jsx("span",{className:s.genreTag,children:a.name},n))}),B?.length>0&&e.jsxs("div",{className:s.keywords,children:[e.jsx(te,{className:s.keywordsIcon}),B.slice(0,6).map((a,n)=>e.jsx("span",{className:s.keywordTag,children:a.name_vn||a.name},n))]}),e.jsxs("div",{className:s.actions,children:[e.jsxs("button",{className:s.watchBtn,onClick:E,children:[e.jsx(T,{})," Xem Ngay"]}),e.jsxs("button",{className:`${s.actionBtn} ${f?s.active:""}`,onClick:()=>A(!f),children:[e.jsx(ne,{}),e.jsx("span",{children:"Yêu thích"})]}),e.jsxs("button",{className:`${s.actionBtn} ${w?s.active:""}`,onClick:()=>D(!w),children:[e.jsx(ie,{}),e.jsx("span",{children:"Lưu lại"})]}),e.jsxs("button",{className:s.actionBtn,onClick:O,children:[e.jsx(le,{}),e.jsx("span",{children:"Chia sẻ"})]})]})]})]})]}),e.jsxs("div",{className:s.tabSection,children:[e.jsx("div",{className:s.tabs,children:g.map(a=>e.jsx("button",{className:`${s.tab} ${o===a?s.tabActive:""}`,onClick:()=>R(a),children:V[a]},a))}),e.jsxs("div",{className:s.tabContent,children:[o==="overview"&&e.jsxs("div",{className:s.overview,children:[e.jsx("h3",{children:"Nội dung"}),e.jsx("p",{className:s.description,children:t.content?oe(t.content):"Đang cập nhật..."}),e.jsxs("div",{className:s.detailGrid,children:[t.country?.length>0&&e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"Quốc gia"}),e.jsx("span",{children:t.country.map(a=>a.name).join(", ")})]}),(p.length>0||t.director?.length>0)&&e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"Đạo diễn"}),e.jsx("span",{children:p.length>0?p.map(a=>a.name).join(", "):t.director.join(", ")})]}),t.status&&e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"Trạng thái"}),e.jsx("span",{children:t.status==="completed"?"Hoàn thành":"Đang cập nhật"})]}),t.episode_total&&e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"Số tập"}),e.jsxs("span",{children:[t.episode_current," / ",t.episode_total]})]})]})]}),o==="episodes"&&e.jsx("div",{className:s.episodesList,children:C.length>0?e.jsx("div",{className:s.episodeGrid,children:C.map((a,n)=>e.jsxs("button",{className:s.episodeBtn,onClick:()=>h(`/watch/${l}`),children:[e.jsx(T,{size:14}),e.jsx("span",{children:a.name})]},n))}):e.jsx("p",{className:s.empty,children:"Chưa có tập phim"})}),o==="cast"&&e.jsx("div",{className:s.castList,children:S.length>0?e.jsx("div",{className:s.castGrid,children:S.map((a,n)=>e.jsxs("div",{className:s.castItem,children:[a.profile_path?e.jsx("img",{src:`${d}/w185${a.profile_path}`,alt:a.name,className:s.castPhoto}):e.jsx("div",{className:s.castAvatar,children:(a.name||"?").charAt(0)}),e.jsxs("div",{className:s.castInfo,children:[e.jsx("span",{className:s.castName,children:a.name}),a.character&&e.jsx("span",{className:s.castRole,children:a.character})]})]},n))}):e.jsx("p",{className:s.empty,children:"Đang cập nhật..."})}),o==="gallery"&&e.jsxs("div",{className:s.gallerySection,children:[c?.backdrops?.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:s.galleryTitle,children:[e.jsx(G,{})," Ảnh nền (",c.backdrops.length,")"]}),e.jsx("div",{className:s.galleryGrid,children:c.backdrops.slice(0,12).map((a,n)=>e.jsx("div",{className:s.galleryItem,onClick:()=>_(`${d}/original${a.file_path}`),children:e.jsx("img",{src:`${d}/w500${a.file_path}`,alt:`Backdrop ${n+1}`,loading:"lazy"})},n))})]}),c?.posters?.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:s.galleryTitle,children:[e.jsx(G,{})," Poster (",c.posters.length,")"]}),e.jsx("div",{className:s.posterGrid,children:c.posters.slice(0,8).map((a,n)=>e.jsx("div",{className:s.galleryItem,onClick:()=>_(`${d}/original${a.file_path}`),children:e.jsx("img",{src:`${d}/w342${a.file_path}`,alt:`Poster ${n+1}`,loading:"lazy"})},n))})]}),I&&e.jsxs("div",{className:s.lightbox,onClick:()=>_(null),children:[e.jsx("img",{src:I,alt:"Full size"}),e.jsx("button",{className:s.lightboxClose,children:"✕"})]})]}),o==="related"&&e.jsx("div",{className:s.relatedSection,children:q.length>0?e.jsx(ce,{title:"Phim tương tự",movies:q}):e.jsx("p",{className:s.empty,children:"Không có phim liên quan"})})]})]})]}),e.jsx($,{})]})};export{xs as default};
