import{j as s}from"./index-CgVwppYc.js";import{e as B,u as H,b as c}from"./vendor-DbVhFtnB.js";import{H as E,f as G,e as $}from"./Header-BXtNmw57.js";import{F as O}from"./Footer-Cmz1iNZx.js";import{M as R}from"./MovieGrid-BQi8BEkf.js";import{m as f}from"./movieService-DXq-Rl6U.js";import"./index-CO4GaNJo.js";import"./MovieCard-hqABC4nK.js";import"./endpoints-DekhD34g.js";const Q="_browse_13kwi_1",Y="_container_13kwi_7",D="_header_13kwi_13",q="_title_13kwi_20",U="_filterToggle_13kwi_27",V="_filtersPanel_13kwi_47",X="_filterGroup_13kwi_68",I="_filterLabel_13kwi_76",K="_filterOptions_13kwi_86",z="_filterChip_13kwi_92",J="_chipActive_13kwi_108",W="_clearBtn_13kwi_115",t={browse:Q,container:Y,header:D,title:q,filterToggle:U,filtersPanel:V,filterGroup:X,filterLabel:I,filterOptions:K,filterChip:z,chipActive:J,clearBtn:W},N=[{name:"Tất cả",slug:""},{name:"Hành Động",slug:"hanh-dong"},{name:"Tình Cảm",slug:"tinh-cam"},{name:"Hài Hước",slug:"hai-huoc"},{name:"Kinh Dị",slug:"kinh-di"},{name:"Viễn Tưởng",slug:"vien-tuong"},{name:"Phiêu Lưu",slug:"phieu-luu"},{name:"Hình Sự",slug:"hinh-su"},{name:"Hoạt Hình",slug:"hoat-hinh"},{name:"Tâm Lý",slug:"tam-ly"},{name:"Chiến Tranh",slug:"chien-tranh"}],w=[{name:"Tất cả",slug:""},{name:"Hàn Quốc",slug:"han-quoc"},{name:"Trung Quốc",slug:"trung-quoc"},{name:"Nhật Bản",slug:"nhat-ban"},{name:"Thái Lan",slug:"thai-lan"},{name:"Âu Mỹ",slug:"au-my"},{name:"Việt Nam",slug:"viet-nam"},{name:"Đài Loan",slug:"dai-loan"},{name:"Ấn Độ",slug:"an-do"}],Z=[{name:"Tất cả",value:""},...Array.from({length:10},(o,u)=>{const h=new Date().getFullYear()-u;return{name:h.toString(),value:h.toString()}})],ee=[{name:"Tất cả",value:""},{name:"Phim lẻ",value:"single"},{name:"Phim bộ",value:"series"}],me=()=>{const[o,u]=B();H();const[h,d]=c.useState([]),[b,p]=c.useState(!0),[y,v]=c.useState(null),[T,_]=c.useState(1),[C,P]=c.useState(!1),[x,S]=c.useState(!0),m=o.get("type")||"",n=o.get("genre")||"",l=o.get("country")||"",r=o.get("year")||"";c.useEffect(()=>{d([]),_(1),j(1)},[m,n,l,r]);const j=async e=>{p(!0),v(null);try{let i;if(n?i=await f.getMoviesByCategory(n,e):l?i=await f.getMoviesByCountry(l,e):r?i=await f.getMoviesByYear(r,e):i=await f.getMovies(e,{type:m}),i?.data?.items){d(e===1?i.data.items:A=>[...A,...i.data.items]);const a=i.data.params?.pagination;a&&P(a.currentPage<a.totalPages)}}catch{v("Lỗi tải danh sách phim")}finally{p(!1)}},L=()=>{const e=T+1;_(e),j(e)},g=(e,i)=>{const a=new URLSearchParams(o);i?(e==="genre"&&(a.delete("country"),a.delete("year")),e==="country"&&(a.delete("genre"),a.delete("year")),e==="year"&&(a.delete("genre"),a.delete("country")),a.set(e,i)):a.delete(e),u(a)},k=()=>{u({})},M=m||n||l||r,F=()=>n?N.find(e=>e.slug===n)?.name||"Thể loại":l?w.find(e=>e.slug===l)?.name||"Quốc gia":r?`Năm ${r}`:m==="single"?"Phim lẻ":m==="series"?"Phim bộ":"Danh mục phim";return s.jsxs(s.Fragment,{children:[s.jsx(E,{}),s.jsx("main",{className:t.browse,children:s.jsxs("div",{className:t.container,children:[s.jsxs("div",{className:t.header,children:[s.jsx("h1",{className:t.title,children:F()}),s.jsxs("button",{className:t.filterToggle,onClick:()=>S(!x),children:[s.jsx(G,{})," Bộ lọc"]})]}),x&&s.jsxs("div",{className:t.filtersPanel,children:[s.jsxs("div",{className:t.filterGroup,children:[s.jsx("span",{className:t.filterLabel,children:"Loại phim"}),s.jsx("div",{className:t.filterOptions,children:ee.map(e=>s.jsx("button",{className:`${t.filterChip} ${m===e.value?t.chipActive:""}`,onClick:()=>g("type",e.value),children:e.name},e.value))})]}),s.jsxs("div",{className:t.filterGroup,children:[s.jsx("span",{className:t.filterLabel,children:"Thể loại"}),s.jsx("div",{className:t.filterOptions,children:N.map(e=>s.jsx("button",{className:`${t.filterChip} ${n===e.slug?t.chipActive:""}`,onClick:()=>g("genre",e.slug),children:e.name},e.slug))})]}),s.jsxs("div",{className:t.filterGroup,children:[s.jsx("span",{className:t.filterLabel,children:"Quốc gia"}),s.jsx("div",{className:t.filterOptions,children:w.map(e=>s.jsx("button",{className:`${t.filterChip} ${l===e.slug?t.chipActive:""}`,onClick:()=>g("country",e.slug),children:e.name},e.slug))})]}),s.jsxs("div",{className:t.filterGroup,children:[s.jsx("span",{className:t.filterLabel,children:"Năm"}),s.jsx("div",{className:t.filterOptions,children:Z.map(e=>s.jsx("button",{className:`${t.filterChip} ${r===e.value?t.chipActive:""}`,onClick:()=>g("year",e.value),children:e.name},e.value))})]}),M&&s.jsxs("button",{className:t.clearBtn,onClick:k,children:[s.jsx($,{})," Xóa bộ lọc"]})]}),s.jsx(R,{movies:h,loading:b,error:y,hasMore:C,onLoadMore:L})]})}),s.jsx(O,{})]})};export{me as default};
