import{j as e,L as Y}from"./index-D7_Flvb3.js";import{h as J,e as Z,b as n}from"./vendor-DTekaQTv.js";import{j as ee,k as se,l as ae,m as te,F as L,n as le,o as ne,p as ie,q as F}from"./index-CWt2mSl_.js";import{H as b}from"./Header-Dhg1R4lm.js";import{F as $}from"./Footer-BhtKaMAj.js";import{M as ce}from"./MovieRow-BUk-XvCA.js";import{m as r}from"./movieService-IRTZGQQP.js";import{g as G,s as oe}from"./helpers-VdV8ob_0.js";import"./firebase-B8FQZRyY.js";import"./MovieCard-qBg1jxw8.js";import"./index-BDRdhlOT.js";import"./endpoints-lq1-MLVT.js";const re="_movieDetail_wdjbw_1",de="_errorPage_wdjbw_7",he="_homeBtn_wdjbw_22",me="_hero_wdjbw_39",_e="_heroImage_wdjbw_46",ge="_heroOverlay_wdjbw_55",je="_heroContent_wdjbw_64",we="_posterWrapper_wdjbw_76",pe="_poster_wdjbw_76",ue="_heroInfo_wdjbw_88",xe="_title_wdjbw_93",be="_originName_wdjbw_101",ve="_metaRow_wdjbw_109",Ne="_ratingBadge_wdjbw_117",ye="_metaBadge_wdjbw_130",fe="_qualityBadge_wdjbw_142",Ie="_langBadge_wdjbw_152",Be="_genres_wdjbw_163",ke="_genreTag_wdjbw_170",Se="_actions_wdjbw_187",Ce="_watchBtn_wdjbw_194",Te="_actionBtn_wdjbw_215",Le="_active_wdjbw_239",Fe="_tabSection_wdjbw_246",$e="_tabs_wdjbw_252",Ge="_tab_wdjbw_246",Re="_tabActive_wdjbw_276",Pe="_tabContent_wdjbw_282",Me="_overview_wdjbw_299",Ae="_description_wdjbw_305",De="_detailGrid_wdjbw_312",qe="_detailItem_wdjbw_318",He="_detailLabel_wdjbw_328",Oe="_episodeGrid_wdjbw_341",Ve="_episodeBtn_wdjbw_347",Ke="_castGrid_wdjbw_369",We="_castItem_wdjbw_375",ze="_castAvatar_wdjbw_385",Ee="_castName_wdjbw_399",Ue="_castPhoto_wdjbw_404",Qe="_castInfo_wdjbw_413",Xe="_castRole_wdjbw_420",Ye="_keywords_wdjbw_429",Je="_keywordsIcon_wdjbw_437",Ze="_keywordTag_wdjbw_443",es="_gallerySection_wdjbw_453",ss="_galleryTitle_wdjbw_457",as="_galleryGrid_wdjbw_466",ts="_posterGrid_wdjbw_473",ls="_galleryItem_wdjbw_480",ns="_lightbox_wdjbw_502",is="_lightboxClose_wdjbw_522",cs="_empty_wdjbw_544",os="_scheduleSection_wdjbw_699",rs="_scheduleTitle_wdjbw_703",ds="_scheduleCard_wdjbw_709",hs="_scheduleInfo_wdjbw_716",ms="_scheduleRow_wdjbw_722",_s="_scheduleLabel_wdjbw_728",gs="_scheduleValue_wdjbw_733",js="_statusOngoing_wdjbw_739",ws="_progressBarSchedule_wdjbw_743",ps="_progressFill_wdjbw_751",s={movieDetail:re,errorPage:de,homeBtn:he,hero:me,heroImage:_e,heroOverlay:ge,heroContent:je,posterWrapper:we,poster:pe,heroInfo:ue,title:xe,originName:be,metaRow:ve,ratingBadge:Ne,metaBadge:ye,qualityBadge:fe,langBadge:Ie,genres:Be,genreTag:ke,actions:Se,watchBtn:Ce,actionBtn:Te,active:Le,tabSection:Fe,tabs:$e,tab:Ge,tabActive:Re,tabContent:Pe,overview:Me,description:Ae,detailGrid:De,detailItem:qe,detailLabel:He,episodeGrid:Oe,episodeBtn:Ve,castGrid:Ke,castItem:We,castAvatar:ze,castName:Ee,castPhoto:Ue,castInfo:Qe,castRole:Xe,keywords:Ye,keywordsIcon:Je,keywordTag:Ze,gallerySection:es,galleryTitle:ss,galleryGrid:as,posterGrid:ts,galleryItem:ls,lightbox:ns,lightboxClose:is,empty:cs,scheduleSection:os,scheduleTitle:rs,scheduleCard:ds,scheduleInfo:hs,scheduleRow:ms,scheduleLabel:_s,scheduleValue:gs,statusOngoing:js,progressBarSchedule:ws,progressFill:ps},d="https://image.tmdb.org/t/p",Ts=()=>{const{slug:i}=J(),h=Z(),[a,R]=n.useState(null),[P,v]=n.useState(!0),[N,m]=n.useState(null),[o,M]=n.useState("overview"),[y,A]=n.useState([]),[f,D]=n.useState(!1),[I,q]=n.useState(!1),[c,H]=n.useState(null),[_,O]=n.useState(null),[B,V]=n.useState(null),[k,g]=n.useState(null);n.useEffect(()=>{K()},[i]);const K=async()=>{v(!0),m(null);try{const t=await r.getMovieDetail(i);if(t?.data?.item){R(t.data.item);const[l,p,u,x]=await Promise.allSettled([t.data.item.category?.length>0?r.getMoviesByCategory(t.data.item.category[0].slug,1):Promise.resolve(null),r.getMovieImages(i),r.getMoviePeoples(i),r.getMovieKeywords(i)]);l.status==="fulfilled"&&l.value?.data?.items&&A(l.value.data.items.filter(X=>X.slug!==i)),p.status==="fulfilled"&&p.value?.data?.images&&H(p.value.data.images),u.status==="fulfilled"&&u.value?.data&&O(u.value.data),x.status==="fulfilled"&&x.value?.data?.keywords&&V(x.value.data.keywords)}else m("Kh√¥ng t√¨m th·∫•y phim")}catch{m("L·ªói t·∫£i th√¥ng tin phim")}finally{v(!1)}},W=()=>h(`/watch/${i}`),z=()=>{navigator.share?navigator.share({title:a.name,url:window.location.href}):navigator.clipboard.writeText(window.location.href)};if(P)return e.jsxs(e.Fragment,{children:[e.jsx(b,{}),e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Y,{})})]});if(N||!a)return e.jsxs(e.Fragment,{children:[e.jsx(b,{}),e.jsxs("div",{className:s.errorPage,children:[e.jsx("h1",{children:N||"Kh√¥ng t√¨m th·∫•y phim"}),e.jsx("button",{className:s.homeBtn,onClick:()=>h("/"),children:"V·ªÅ trang ch·ªß"})]}),e.jsx($,{})]});const E=G(a.poster_url||a.thumb_url),U=G(a.thumb_url||a.poster_url),S=a.tmdb?.vote_average||0,C=a.episodes?.[0]?.server_data||[],j=["overview","episodes","cast"];(c?.backdrops?.length>0||c?.posters?.length>0)&&j.push("gallery"),j.push("related");const Q={overview:"T·ªïng quan",episodes:"T·∫≠p phim",cast:"Di·ªÖn vi√™n",gallery:"H√¨nh ·∫£nh",related:"ƒê·ªÅ xu·∫•t"},T=_?.cast?.length>0?_.cast.slice(0,20):a.actor?.map(t=>({name:t,profile_path:null}))||[],w=_?.crew?.filter(t=>t.job==="Director")||[];return e.jsxs(e.Fragment,{children:[e.jsx(b,{}),e.jsxs("main",{className:s.movieDetail,children:[e.jsxs("div",{className:s.hero,children:[e.jsx("img",{src:E,alt:"",className:s.heroImage}),e.jsx("div",{className:s.heroOverlay}),e.jsxs("div",{className:s.heroContent,children:[e.jsx("div",{className:s.posterWrapper,children:e.jsx("img",{src:U,alt:a.name,className:s.poster})}),e.jsxs("div",{className:s.heroInfo,children:[e.jsx("h1",{className:s.title,children:a.origin_name||a.name}),a.origin_name&&a.name!==a.origin_name&&e.jsx("p",{className:s.originName,children:a.name}),e.jsxs("div",{className:s.metaRow,children:[S>0&&e.jsxs("span",{className:s.ratingBadge,children:[e.jsx(ee,{})," ",S.toFixed(1)]}),a.year&&e.jsxs("span",{className:s.metaBadge,children:[e.jsx(se,{})," ",a.year]}),a.time&&e.jsxs("span",{className:s.metaBadge,children:[e.jsx(ae,{})," ",a.time]}),a.quality&&e.jsx("span",{className:s.qualityBadge,children:a.quality}),a.lang&&e.jsx("span",{className:s.langBadge,children:a.lang}),a.episode_current&&e.jsx("span",{className:s.metaBadge,children:a.episode_current})]}),a.category?.length>0&&e.jsx("div",{className:s.genres,children:a.category.map((t,l)=>e.jsx("span",{className:s.genreTag,children:t.name},l))}),B?.length>0&&e.jsxs("div",{className:s.keywords,children:[e.jsx(te,{className:s.keywordsIcon}),B.slice(0,6).map((t,l)=>e.jsx("span",{className:s.keywordTag,children:t.name_vn||t.name},l))]}),e.jsxs("div",{className:s.actions,children:[e.jsxs("button",{className:s.watchBtn,onClick:W,children:[e.jsx(L,{})," Xem Ngay"]}),e.jsxs("button",{className:`${s.actionBtn} ${f?s.active:""}`,onClick:()=>D(!f),children:[e.jsx(le,{}),e.jsx("span",{children:"Y√™u th√≠ch"})]}),e.jsxs("button",{className:`${s.actionBtn} ${I?s.active:""}`,onClick:()=>q(!I),children:[e.jsx(ne,{}),e.jsx("span",{children:"L∆∞u l·∫°i"})]}),e.jsxs("button",{className:s.actionBtn,onClick:z,children:[e.jsx(ie,{}),e.jsx("span",{children:"Chia s·∫ª"})]})]})]})]})]}),e.jsxs("div",{className:s.tabSection,children:[e.jsx("div",{className:s.tabs,children:j.map(t=>e.jsx("button",{className:`${s.tab} ${o===t?s.tabActive:""}`,onClick:()=>M(t),children:Q[t]},t))}),e.jsxs("div",{className:s.tabContent,children:[o==="overview"&&e.jsxs("div",{className:s.overview,children:[e.jsx("h3",{children:"N·ªôi dung"}),e.jsx("p",{className:s.description,children:a.content?oe(a.content):"ƒêang c·∫≠p nh·∫≠t..."}),e.jsxs("div",{className:s.detailGrid,children:[a.country?.length>0&&e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"Qu·ªëc gia"}),e.jsx("span",{children:a.country.map(t=>t.name).join(", ")})]}),(w.length>0||a.director?.length>0)&&e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"ƒê·∫°o di·ªÖn"}),e.jsx("span",{children:w.length>0?w.map(t=>t.name).join(", "):a.director.join(", ")})]}),a.status&&e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"Tr·∫°ng th√°i"}),e.jsx("span",{children:a.status==="completed"?"Ho√†n th√†nh":"ƒêang c·∫≠p nh·∫≠t"})]}),a.episode_total&&e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"S·ªë t·∫≠p"}),e.jsxs("span",{children:[a.episode_current," / ",a.episode_total]})]})]}),a.type==="series"&&a.status!=="completed"&&e.jsxs("div",{className:s.scheduleSection,children:[e.jsx("h3",{className:s.scheduleTitle,children:"üìÖ L·ªãch chi·∫øu"}),e.jsx("div",{className:s.scheduleCard,children:e.jsxs("div",{className:s.scheduleInfo,children:[e.jsxs("div",{className:s.scheduleRow,children:[e.jsx("span",{className:s.scheduleLabel,children:"Ti·∫øn ƒë·ªô"}),e.jsxs("span",{className:s.scheduleValue,children:[a.episode_current||"?"," / ",a.episode_total||"?"," t·∫≠p"]})]}),e.jsx("div",{className:s.progressBarSchedule,children:e.jsx("div",{className:s.progressFill,style:{width:a.episode_total?`${parseInt(a.episode_current)/parseInt(a.episode_total)*100}%`:"0%"}})}),e.jsxs("div",{className:s.scheduleRow,children:[e.jsx("span",{className:s.scheduleLabel,children:"Tr·∫°ng th√°i"}),e.jsx("span",{className:`${s.scheduleValue} ${s.statusOngoing}`,children:"üî¥ ƒêang ph√°t s√≥ng"})]}),e.jsxs("div",{className:s.scheduleRow,children:[e.jsx("span",{className:s.scheduleLabel,children:"C·∫≠p nh·∫≠t"}),e.jsx("span",{className:s.scheduleValue,children:"H√†ng tu·∫ßn"})]})]})})]})]}),o==="episodes"&&e.jsx("div",{className:s.episodesList,children:C.length>0?e.jsx("div",{className:s.episodeGrid,children:C.map((t,l)=>e.jsxs("button",{className:s.episodeBtn,onClick:()=>h(`/watch/${i}`),children:[e.jsx(L,{size:14}),e.jsx("span",{children:t.name})]},l))}):e.jsx("p",{className:s.empty,children:"Ch∆∞a c√≥ t·∫≠p phim"})}),o==="cast"&&e.jsx("div",{className:s.castList,children:T.length>0?e.jsx("div",{className:s.castGrid,children:T.map((t,l)=>e.jsxs("div",{className:s.castItem,children:[t.profile_path?e.jsx("img",{src:`${d}/w185${t.profile_path}`,alt:t.name,className:s.castPhoto}):e.jsx("div",{className:s.castAvatar,children:(t.name||"?").charAt(0)}),e.jsxs("div",{className:s.castInfo,children:[e.jsx("span",{className:s.castName,children:t.name}),t.character&&e.jsx("span",{className:s.castRole,children:t.character})]})]},l))}):e.jsx("p",{className:s.empty,children:"ƒêang c·∫≠p nh·∫≠t..."})}),o==="gallery"&&e.jsxs("div",{className:s.gallerySection,children:[c?.backdrops?.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:s.galleryTitle,children:[e.jsx(F,{})," ·∫¢nh n·ªÅn (",c.backdrops.length,")"]}),e.jsx("div",{className:s.galleryGrid,children:c.backdrops.slice(0,12).map((t,l)=>e.jsx("div",{className:s.galleryItem,onClick:()=>g(`${d}/original${t.file_path}`),children:e.jsx("img",{src:`${d}/w500${t.file_path}`,alt:`Backdrop ${l+1}`,loading:"lazy"})},l))})]}),c?.posters?.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:s.galleryTitle,children:[e.jsx(F,{})," Poster (",c.posters.length,")"]}),e.jsx("div",{className:s.posterGrid,children:c.posters.slice(0,8).map((t,l)=>e.jsx("div",{className:s.galleryItem,onClick:()=>g(`${d}/original${t.file_path}`),children:e.jsx("img",{src:`${d}/w342${t.file_path}`,alt:`Poster ${l+1}`,loading:"lazy"})},l))})]}),k&&e.jsxs("div",{className:s.lightbox,onClick:()=>g(null),children:[e.jsx("img",{src:k,alt:"Full size"}),e.jsx("button",{className:s.lightboxClose,children:"‚úï"})]})]}),o==="related"&&e.jsx("div",{className:s.relatedSection,children:y.length>0?e.jsx(ce,{title:"Phim t∆∞∆°ng t·ª±",movies:y}):e.jsx("p",{className:s.empty,children:"Kh√¥ng c√≥ phim li√™n quan"})})]})]})]}),e.jsx($,{})]})};export{Ts as default};
