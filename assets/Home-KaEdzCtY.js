import{j as e}from"./index-Ce0K8VUX.js";import{b as o,e as M}from"./vendor-DTekaQTv.js";import{H as S}from"./Header-aWFzr601.js";import{g as y,F as C}from"./helpers-CsWJ-lTd.js";import{F as B,a as T,b as w,c as I}from"./index-D5LGCugf.js";import{M as f}from"./MovieRow-DFzDVBx_.js";import{m as _}from"./movieService-BaVLUEmp.js";import"./firebase-B8FQZRyY.js";import"./MovieCard-DZwTorOR.js";import"./index-BDRdhlOT.js";import"./endpoints-xqRzFTK4.js";const F="_heroBanner_11mpi_1",P="_backdrop_11mpi_21",A="_backdropImage_11mpi_33",$="_gradientOverlay_11mpi_49",R="_content_11mpi_69",E="_info_11mpi_91",H="_title_11mpi_101",O="_originName_11mpi_121",L="_meta_11mpi_135",D="_rating_11mpi_151",U="_badge_11mpi_171",z="_categories_11mpi_189",X="_categoryTag_11mpi_203",q="_actions_11mpi_221",G="_playBtn_11mpi_231",J="_infoBtn_11mpi_273",K="_thumbnails_11mpi_319",Q="_thumbnail_11mpi_319",V="_thumbnailActive_11mpi_379",W="_navPrev_11mpi_395",Y="_navNext_11mpi_397",Z="_dots_11mpi_479",ee="_dot_11mpi_479",te="_dotActive_11mpi_521",t={heroBanner:F,backdrop:P,backdropImage:A,gradientOverlay:$,content:R,info:E,title:H,originName:O,meta:L,rating:D,badge:U,categories:z,categoryTag:X,actions:q,playBtn:G,infoBtn:J,thumbnails:K,thumbnail:Q,thumbnailActive:V,navPrev:W,navNext:Y,dots:Z,dot:ee,dotActive:te},se=({movies:x=[]})=>{const[c,b]=o.useState(0),[m,g]=o.useState(!1),u=M(),n=x.slice(0,8),r=o.useCallback(i=>{m||(g(!0),b(i),setTimeout(()=>g(!1),600))},[m]),d=o.useCallback(()=>{r((c+1)%n.length)},[c,n.length,r]),j=o.useCallback(()=>{r((c-1+n.length)%n.length)},[c,n.length,r]);if(o.useEffect(()=>{if(n.length<=1)return;const i=setInterval(d,6e3);return()=>clearInterval(i)},[d,n.length]),n.length===0)return null;const s=n[c],p=y(s.poster_url||s.thumb_url),v=s.tmdb?.vote_average||0,l=s.origin_name||s.name;return e.jsxs("section",{className:t.heroBanner,children:[e.jsxs("div",{className:t.backdrop,children:[e.jsx("img",{src:p,alt:l,className:t.backdropImage,fetchpriority:"high",loading:"eager",width:1920,height:1080},c),e.jsx("div",{className:t.gradientOverlay})]}),e.jsxs("div",{className:t.content,children:[e.jsxs("div",{className:t.info,children:[e.jsx("h1",{className:t.title,children:l},`title-${c}`),s.origin_name&&s.name!==s.origin_name&&e.jsx("p",{className:t.originName,children:s.name}),e.jsxs("div",{className:t.meta,children:[v>0&&e.jsxs("span",{className:t.rating,children:["⭐ ",v.toFixed(1)]}),s.year&&e.jsx("span",{className:t.badge,children:s.year}),s.time&&e.jsx("span",{className:t.badge,children:s.time}),s.episode_current&&e.jsx("span",{className:t.badge,children:s.episode_current})]}),s.category&&s.category.length>0&&e.jsx("div",{className:t.categories,children:s.category.slice(0,3).map((i,a)=>e.jsx("span",{className:t.categoryTag,children:i.name},a))}),e.jsxs("div",{className:t.actions,children:[e.jsxs("button",{className:t.playBtn,onClick:()=>u(`/watch/${s.slug}`),children:[e.jsx(B,{})," Xem ngay"]}),e.jsxs("button",{className:t.infoBtn,onClick:()=>u(`/movie/${s.slug}`),children:[e.jsx(T,{})," Chi tiết"]})]})]}),e.jsx("div",{className:t.thumbnails,children:n.map((i,a)=>e.jsx("div",{className:`${t.thumbnail} ${a===c?t.thumbnailActive:""}`,onClick:()=>r(a),children:e.jsx("img",{src:y(i.thumb_url||i.poster_url),alt:i.origin_name||i.name,loading:"lazy",width:120,height:68})},i.slug||a))})]}),e.jsx("button",{className:t.navPrev,onClick:j,children:e.jsx(w,{})}),e.jsx("button",{className:t.navNext,onClick:d,children:e.jsx(I,{})}),e.jsx("div",{className:t.dots,children:n.map((i,a)=>e.jsx("button",{className:`${t.dot} ${a===c?t.dotActive:""}`,onClick:()=>r(a)},a))})]})},ae="_home_1kud3_1",ie="_sections_1kud3_6",k={home:ae,sections:ie},pe=()=>{const[x,c]=o.useState([]),[b,m]=o.useState([]),[g,u]=o.useState([]),[n,r]=o.useState([]),[d,j]=o.useState([]),[s,p]=o.useState(!0);o.useEffect(()=>{v()},[]);const v=async()=>{p(!0);try{let l=!1;try{const h=await _.getHomeData();if(h?.data?.items){const N=h.data.items;c(N.slice(0,8)),m(N),l=!0}}catch{}const i=[_.getSeries(1,24),_.getSingleMovies(1,24),_.getMoviesByCategory("hanh-dong",1,"modified.time")];l||i.push(_.getNewReleases(1,24));const a=await Promise.allSettled(i);if(a[0].status==="fulfilled"&&a[0].value?.data?.items&&u(a[0].value.data.items),a[1].status==="fulfilled"&&a[1].value?.data?.items&&r(a[1].value.data.items),a[2].status==="fulfilled"&&a[2].value?.data?.items&&j(a[2].value.data.items),!l&&a[3]?.status==="fulfilled"&&a[3].value?.data?.items){const h=a[3].value.data.items;c(h.slice(0,8)),m(h)}}catch(l){console.error("Error fetching home data:",l)}finally{p(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(S,{}),e.jsxs("main",{className:k.home,children:[e.jsx(se,{movies:x}),e.jsxs("div",{className:k.sections,children:[e.jsx(f,{title:"Phim Mới Cập Nhật",movies:b,loading:s,linkTo:"/browse"}),e.jsx(f,{title:"Phim Chiếu Rạp",movies:d,loading:s,linkTo:"/browse?type=hoathinh"}),e.jsx(f,{title:"Phim Bộ Mới",movies:g,loading:s,linkTo:"/browse?type=series"}),e.jsx(f,{title:"Phim Lẻ Mới",movies:n,loading:s,linkTo:"/browse?type=single"})]})]}),e.jsx(C,{})]})};export{pe as default};
