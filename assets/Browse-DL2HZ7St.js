import{j as s}from"./index-Dww8Xo-m.js";import{e as H,u as E,b as c}from"./vendor-DbVhFtnB.js";import{H as G,f as $,e as O}from"./Header-CKznWeIE.js";import{F as R}from"./Footer-BtG0UkGS.js";import{M as Q}from"./MovieGrid-CSERHFAn.js";import{m as g}from"./movieService-DyBGQg6k.js";import"./index-CO4GaNJo.js";import"./MovieCard-ChKncVvd.js";import"./endpoints-fMD0dIgT.js";const Y="_browse_winf2_1",k="_container_winf2_7",D="_header_winf2_13",q="_title_winf2_20",U="_filterToggle_winf2_27",V="_filtersPanel_winf2_47",X="_filterGroup_winf2_68",I="_filterLabel_winf2_76",K="_filterOptions_winf2_86",z="_filterChip_winf2_92",J="_chipActive_winf2_108",W="_clearBtn_winf2_115",t={browse:Y,container:k,header:D,title:q,filterToggle:U,filtersPanel:V,filterGroup:X,filterLabel:I,filterOptions:K,filterChip:z,chipActive:J,clearBtn:W},N=[{name:"Tất cả",slug:""},{name:"Hành Động",slug:"hanh-dong"},{name:"Tình Cảm",slug:"tinh-cam"},{name:"Hài Hước",slug:"hai-huoc"},{name:"Kinh Dị",slug:"kinh-di"},{name:"Viễn Tưởng",slug:"vien-tuong"},{name:"Phiêu Lưu",slug:"phieu-luu"},{name:"Hình Sự",slug:"hinh-su"},{name:"Hoạt Hình",slug:"hoat-hinh"},{name:"Tâm Lý",slug:"tam-ly"},{name:"Chiến Tranh",slug:"chien-tranh"}],w=[{name:"Tất cả",slug:""},{name:"Hàn Quốc",slug:"han-quoc"},{name:"Trung Quốc",slug:"trung-quoc"},{name:"Nhật Bản",slug:"nhat-ban"},{name:"Thái Lan",slug:"thai-lan"},{name:"Âu Mỹ",slug:"au-my"},{name:"Việt Nam",slug:"viet-nam"},{name:"Đài Loan",slug:"dai-loan"},{name:"Ấn Độ",slug:"an-do"}],Z=[{name:"Tất cả",value:""},...Array.from({length:10},(o,u)=>{const h=new Date().getFullYear()-u;return{name:h.toString(),value:h.toString()}})],ee=[{name:"Tất cả",value:""},{name:"Phim lẻ",value:"single"},{name:"Phim bộ",value:"series"}],me=()=>{const[o,u]=H();E();const[h,d]=c.useState([]),[b,p]=c.useState(!0),[y,v]=c.useState(null),[T,_]=c.useState(1),[C,P]=c.useState(!1),[x,S]=c.useState(!0),m=o.get("type")||"",n=o.get("genre")||"",l=o.get("country")||"",r=o.get("year")||"";c.useEffect(()=>{d([]),_(1),j(1)},[m,n,l,r]);const j=async e=>{p(!0),v(null);try{let i;if(n?i=await g.getMoviesByCategory(n,e):l?i=await g.getMoviesByCountry(l,e):r?i=await g.getMoviesByYear(r,e):i=await g.getMovies(e,{type:m}),i?.data?.items){d(e===1?i.data.items:B=>[...B,...i.data.items]);const a=i.data.params?.pagination;a&&P(a.currentPage<a.totalPages)}}catch{v("Lỗi tải danh sách phim")}finally{p(!1)}},L=()=>{const e=T+1;_(e),j(e)},f=(e,i)=>{const a=new URLSearchParams(o);i?(e==="genre"&&(a.delete("country"),a.delete("year")),e==="country"&&(a.delete("genre"),a.delete("year")),e==="year"&&(a.delete("genre"),a.delete("country")),a.set(e,i)):a.delete(e),u(a)},M=()=>{u({})},F=m||n||l||r,A=()=>n?N.find(e=>e.slug===n)?.name||"Thể loại":l?w.find(e=>e.slug===l)?.name||"Quốc gia":r?`Năm ${r}`:m==="single"?"Phim lẻ":m==="series"?"Phim bộ":"Danh mục phim";return s.jsxs(s.Fragment,{children:[s.jsx(G,{}),s.jsx("main",{className:t.browse,children:s.jsxs("div",{className:t.container,children:[s.jsxs("div",{className:t.header,children:[s.jsx("h1",{className:t.title,children:A()}),s.jsxs("button",{className:t.filterToggle,onClick:()=>S(!x),children:[s.jsx($,{})," Bộ lọc"]})]}),x&&s.jsxs("div",{className:t.filtersPanel,children:[s.jsxs("div",{className:t.filterGroup,children:[s.jsx("span",{className:t.filterLabel,children:"Loại phim"}),s.jsx("div",{className:t.filterOptions,children:ee.map(e=>s.jsx("button",{className:`${t.filterChip} ${m===e.value?t.chipActive:""}`,onClick:()=>f("type",e.value),children:e.name},e.value))})]}),s.jsxs("div",{className:t.filterGroup,children:[s.jsx("span",{className:t.filterLabel,children:"Thể loại"}),s.jsx("div",{className:t.filterOptions,children:N.map(e=>s.jsx("button",{className:`${t.filterChip} ${n===e.slug?t.chipActive:""}`,onClick:()=>f("genre",e.slug),children:e.name},e.slug))})]}),s.jsxs("div",{className:t.filterGroup,children:[s.jsx("span",{className:t.filterLabel,children:"Quốc gia"}),s.jsx("div",{className:t.filterOptions,children:w.map(e=>s.jsx("button",{className:`${t.filterChip} ${l===e.slug?t.chipActive:""}`,onClick:()=>f("country",e.slug),children:e.name},e.slug))})]}),s.jsxs("div",{className:t.filterGroup,children:[s.jsx("span",{className:t.filterLabel,children:"Năm"}),s.jsx("div",{className:t.filterOptions,children:Z.map(e=>s.jsx("button",{className:`${t.filterChip} ${r===e.value?t.chipActive:""}`,onClick:()=>f("year",e.value),children:e.name},e.value))})]}),F&&s.jsxs("button",{className:t.clearBtn,onClick:M,children:[s.jsx(O,{})," Xóa bộ lọc"]})]}),s.jsx(Q,{movies:h,loading:b,error:y,hasMore:C,onLoadMore:L})]})}),s.jsx(R,{})]})};export{me as default};
